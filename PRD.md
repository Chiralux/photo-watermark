# 产品需求文档（PRD）

## 一、产品背景

随着数码摄影的普及，用户常常需要在照片上添加拍摄时间作为水印，便于管理和分享。现有工具多为手动操作，缺乏批量自动化和自定义水印样式的能力。为此，开发一款命令行工具，自动读取图片 EXIF 拍摄时间并批量添加水印，提升效率和体验。

## 二、产品目标

开发一个 Java 命令行程序，实现以下功能：

- 批量读取指定目录下图片的 EXIF 拍摄时间信息。
- 自动将拍摄日期作为水印添加到图片上。
- 支持用户自定义水印字体大小、颜色和位置。
- 生成新图片文件，统一保存到原目录下的 `_watermark` 子目录。

## 三、核心功能需求

### 1. 图片路径输入

- 用户通过命令行参数输入图片文件或目录路径。
- 支持批量处理目录下所有图片文件（jpg/jpeg/png）。

### 2. EXIF 信息读取

- 自动读取每张图片的 EXIF 拍摄时间（年月日）。
- 若无拍摄时间，则跳过或提示。

### 3. 水印参数设置

- 用户可通过命令行参数设置：
  - 字体大小（如：12、24、36）
  - 字体颜色（如：#FFFFFF、red）
  - 水印位置（左上角、居中、右下角）

### 4. 水印绘制

- 将拍摄日期作为文本水印绘制到图片指定位置。
- 保证水印清晰可见，不遮挡主要内容。

### 5. 图片保存

- 新图片保存到原目录下的 `_watermark` 子目录。
- 文件名与原图片一致，格式不变。

### 6. 错误处理与提示

- 路径不存在、图片格式不支持、EXIF 信息缺失等情况需有友好提示。
- 批量处理时，统计成功与失败数量。

## 四、非功能性需求

- 遵循单一职责原则，代码结构清晰，便于维护和扩展。
- 依赖库需开源且易于获取（如 metadata-extractor、commons-cli）。
- 支持 Windows、Mac、Linux 主流平台。

## 五、用户界面（命令行参数示例）

```shell
java -jar photo-watermark.jar -p "C:\photos" -size 24 -color "#FF0000" -pos "right-bottom"
```

参数说明：

- `-p`：图片文件或目录路径
- `-size`：字体大小
- `-color`：字体颜色
- `-pos`：水印位置（left-top、center、right-bottom）

## 六、目录结构

- 主程序入口
- 命令行参数解析
- EXIF 信息读取
- 水印参数封装
- 水印绘制
- 图片保存

## 七、交付标准

- 提供完整源码及构建说明
- 提供使用说明文档
- 代码通过基本测试，能正确处理常见图片

